<!DOCTYPE html>
<html>
<head>
    <title>系统主页</title>
    <meta charset= 'utf-8' />
    <script src="{{ url_for('static', filename = 'js/flexible.js') }}"></script>
    <script src="{{ url_for('static', filename = 'js/jquery.js') }}"></script>
    <script src="{{ url_for('static', filename = 'js/echarts.min.js') }}"></script>
    <link rel="stylesheet", href="{{ url_for('static', filename='css/style.css') }}" />
</head>
<body style="background: url('../static/images/bg_3.jpg') no-repeat top center; line-height: 1.1">
<header>
    <h1>客户数据分析系统</h1>
    <div class="showTime"></div>
    <script>
        var t = null;
        t = setTimeout(time, 1000);

        function time() {
            clearTimeout(t);
            dt = new Date();
            var y = dt.getFullYear();
            var mt = dt.getMonth() + 1;


            var day = dt.getDate();
            var h = dt.getHours();
            var m = dt.getMinutes();
            var s = dt.getSeconds();
            document.querySelector(".showTime").innerHTML = '当前时间：' + y + "年" + mt + "月" + day + "日-" + h + "时" + m + "分" + s + "秒";
            t = setTimeout(time, 1000);
        }
    </script>
</header>
<section>
    <div class="center">
        <div class="box">
            <div>
                <svg t="1687079557471" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2393" xmlns:xlink="http://www.w3.org/1999/xlink" width="150" height="150"><path d="M321.6 346.5h381c21.4 0 39-17.5 39-39 0-21.4-17.5-39-39-39h-381c-21.4 0-39 17.5-39 39 0 21.4 17.5 39 39 39zM282.6 488.5c0 21.4 17.5 39 39 39H606c21.4 0 39-17.5 39-39 0-21.4-17.5-39-39-39H321.6c-21.5 0-39 17.5-39 39z" p-id="2394" fill="#ffffff"></path><path d="M908.5 113.9c0-27.6-22.4-50-50-50H166.8c-27.6 0-50 22.4-50 50v794.7c0 27.6 22.4 50 50 50h307.3c20.8-0.3 37.5-17.2 37.5-38s-16.7-37.7-37.5-38H192.8V139.9h639.7v400.8c0 21 17 38 38 38s38-17 38-38V113.9z" p-id="2395" fill="#ffffff"></path><path d="M767.2 598.9c-15.8-15.8-41.8-15.8-57.6 0l-95.9 95.9c-15.9 15.9-15.9 41.8 0 57.6 15.8 15.8 41.8 15.8 57.6 0l26.3-26.3v188.1c0 22.4 18.3 40.7 40.7 40.7 22.4 0 40.7-18.3 40.7-40.7V726.1l26.3 26.3c15.8 15.8 41.8 15.8 57.6 0 15.8-15.8 15.8-41.8 0-57.6l-95.7-95.9z" p-id="2396" fill="#ffffff"></path></svg>
            </div>
            <div>
                <div style="flex-direction: column;flex-wrap: wrap;align-content: center;justify-content: center;align-items: center;display: flex;">
                    <label class='btn import' for="import">上传文件</label>
                </div>
                <div>
                    <label>选择：</label>
                    <select class='filelist' style="width:60%">
                        <!-- jinja模板生成列表 -->
                        {% for file in files %}
                            <option>{{ file }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div>
                <input id='import' type="file" name="file" style="display:none" onchange="upload()"/>
            </div>
        </div>
        <div class="box">
            <div>
                <svg t="1687078976064" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1278" width="150" height="150" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M144 464H80a16 16 0 0 0 0 32h64a16 16 0 0 0 0-32z" fill="#ffffff" p-id="1279"></path><path d="M944 464h-64a16 16 0 0 0 0 32h64a16 16 0 0 0 0-32z" fill="#ffffff" p-id="1280"></path><path d="M512 144a336 336 0 1 1-336 336A336 336 0 0 1 512 144z m0-48a384 384 0 1 0 384 384A384 384 0 0 0 512 96z" fill="#ffffff" p-id="1281"></path><path d="M766.24 710.24A24 24 0 0 0 749.28 752l169.76 168.96a24 24 0 1 0 33.92-33.92L784 717.28a24 24 0 0 0-16.96-7.04z" fill="#ffffff" p-id="1282"></path><path d="M504 672h-0.96a16 16 0 0 1-14.4-11.84l-82.88-304-46.72 128a16 16 0 0 1-15.04 10.56h-96a16 16 0 0 1 0-32h84.8l60.16-165.44a16 16 0 0 1 30.72 1.28l83.68 306.72 94.24-228.64a16 16 0 0 1 13.12-9.76 16 16 0 0 1 14.88 7.04L688 464h88a16 16 0 0 1 0 32h-96a16 16 0 0 1-13.28-7.2l-48-70.88-100 244.16a16 16 0 0 1-14.72 9.92z" fill="#ffffff" p-id="1283"></path></svg>
            </div>
            <div>
                <label class="btn show" onclick="window.location.href='/query'">数据查询</label>
            </div>
        </div>
        <div class="box">
            <div>
                <svg t="1687079463637" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2032" xmlns:xlink="http://www.w3.org/1999/xlink" width="150" height="150"><path d="M260.2 884.1H97.7v-203h162.4v203z m-123.9-38.6h85.3V719.6h-85.3v125.9zM463.2 884.1H300.8V599.8h162.4v284.3z m-123.8-38.6h85.3V638.4h-85.3v207.1zM666.3 884.1H503.9V478h162.4v406.1z m-123.8-38.6h85.3v-329h-85.3v329zM869.3 884.1H706.9V396.8h162.4v487.3z m-123.8-38.6h85.3V435.4h-85.3v410.1z" fill="#ffffff" p-id="2033"></path><path d="M150.1 574l-27.4-27.3 204.7-205.4 115.5 119.3 206.3-215.8 84.2 75.2L862 159.8l30.1 24.1-154 192-86.8-77.5-208.2 217.9-116-119.9z" fill="#ffffff" p-id="2034"></path><path d="M927.7 309.2h-38.5v-129H741.8v-38.5h185.9z" fill="#ffffff" p-id="2035"></path></svg>
            </div>
            <div>
                <label class="btn statistics_analysis" onclick="window.location.href='/statistics_analysis'">统计数据分析</label>
            </div>
            <div>
                <label class="btn cluster_analysis" onclick="window.location.href='/cluster_analysis'">聚类数据分析</label>
            </div>
        </div>
        <div class="box">
            <div>
                <svg t="1687079510593" class="icon" viewBox="0 0 1041 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2212" xmlns:xlink="http://www.w3.org/1999/xlink" width="150" height="150"><path d="M58.828283 129.939394h735.547475v285.349495h58.828282V71.111111H0v764.89697h382.448485v-58.828283H58.828283V129.939394z m717.834343 579.620202c-35.29697 0-64.775758 29.478788-64.775757 67.620202 0 35.29697 29.478788 67.620202 64.775757 67.620202s64.775758-29.478788 64.775758-67.620202c2.973737-35.29697-26.505051-67.620202-64.775758-67.620202z m0 0" p-id="2213" fill="#ffffff"></path><path d="M776.662626 600.694949c-173.640404 0-264.791919 176.484848-264.791919 176.484849s67.620202 176.484848 264.791919 176.484848c179.458586 0 264.791919-176.484848 264.791919-176.484848s-88.177778-176.484848-264.791919-176.484849z m0 288.323233c-64.775758 0-108.864646-47.062626-108.864646-111.838384 0-61.80202 47.062626-108.864646 108.864646-108.864646 64.775758 0 108.864646 47.062626 108.864647 108.864646 2.973737 61.80202-44.088889 111.838384-108.864647 111.838384z m-555.959596-670.771717h58.828283v353.09899H220.70303V218.246465z m176.484849 76.412121h58.828283v276.557576h-58.828283V294.658586z m176.484848 50.036363h58.828283v226.521213h-58.828283V344.694949z m0 0" p-id="2214" fill="#ffffff"></path></svg>
            </div>
            <div>
                <label class="btn result" onclick="window.location.href='/result'">结果展示</label>
            </div>
        </div>
    </div>
    <script>
        <!-- 上传文件的函数 -->
        function upload() {
            var files = $('#import').prop('files');

            var filedata = new FormData();
            filedata.append('file_data', files[0]);
            filedata.append('file_name', files[0].name)

            // 利用ajax异步上传至服务器
            $.ajax({
                type: 'POST',
                url: "/upload",
                data: filedata,
                cache: false,
                processData: false,
                contentType: false,
                success: function (response) {
                    $('.filelist').append('<option>' + files[0].name + '</option>')

                },
                error: function() {

                }
            });
        }
        // 监听选择的文件是否改变
        $('.filelist').on('change', function() {
            filename = $('.filelist option:selected').text()
            console.log(filename)

            // 利用ajax异步将所选择的文件名上传至后端
            $.ajax({
                url: '/changeChosen',
                type: 'POST',
                data: {
                    'filename': filename
                }
            })
        })
    </script>
</section>
</body>
</html>